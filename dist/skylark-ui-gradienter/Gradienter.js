/**
 * skylark-ui-gradienter - The skylark gradient picker widget
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylarkui/skylark-ui-gradienter/
 * @license MIT
 */
define(["skylark-langx/skylark","skylark-langx/langx","skylark-utils/browser","skylark-utils/noder","skylark-utils/eventer","skylark-utils/finder","skylark-utils/query","skylark-utils-color/colors","skylark-utils-color/Color","skylark-ui-swt/ui","skylark-ui-swt/Widget","skylark-ui-colorpicker/ColorPicker","./Drag"],function(e,t,i,r,s,a,d,n,l,o,_,g,c){"use strict";"undefined"==typeof d.fn.draggable&&(d.fn.draggable=function(){var e=document.getElementById(this.attr("id"));return e.style.top="121px",c.init(e,null,26,426,86,86),this});var p=o.Gradienter=function(e,i){function r(e,t,i){e.attachEvent?e.attachEvent("on"+t,function(){i.call(e)}):e.addEventListener&&e.addEventListener(t,i,!1)}var s={targets:[],sliders:[],direction:"left",type:"linear",code_shown:!1,change:function(e,t){}},a=c.gradx={rand_RGB:[],rand_pos:[],id:null,slider_ids:[],slider_index:0,sliders:[],direction:"left",type:"linear",shape:"cover",slider_hovered:[],jQ_present:!0,code_shown:!1,load_jQ:function(){this.gx=d},add_event:function(e,t,i){r(e,t,i)},get_random_position:function(){var e;do e=parseInt(100*Math.random());while(this.rand_pos.indexOf(e)>-1);return this.rand_pos.push(e),e},get_random_rgb:function(){var e,t,i,r;do e=parseInt(255*Math.random()),t=parseInt(255*Math.random()),i=parseInt(255*Math.random()),r="rgb("+e+", "+t+", "+i+")";while(this.rand_RGB.indexOf(r)>-1);return this.rand_RGB.push(r),r},update_target:function(e){if(this.targets.length>0){var t,i,r,s=this.targets.length,d=e.length;for(t=0;t<s;t++)for(r=a.gx(this.targets[t]),i=0;i<d;i++)r.css("background-image",e[i])}},apply_style:function(e,t){var i="linear";if("linear"!=a.type&&(i="radial"),t.indexOf(this.direction)>-1)var r=["-webkit-"+i+"-gradient("+t+")","-moz-"+i+"-gradient("+t+")","-ms-"+i+"-gradient("+t+")","-o-"+i+"-gradient("+t+")",i+"-gradient("+t+")"];else r=[t];for(var s=r.length,d="";s>0;)s--,e.css("background",r[s]),d+="background: "+r[s]+";\n";this.change(this.sliders,r),this.update_target(r),a.gx("#gradx_code").html(d)},apply_default_styles:function(){this.update_style_array();var e=this.get_style_value();this.apply_style(this.panel,e)},update_style_array:function(){this.sliders=[];var e,t,i,r,s=a.slider_ids.length;for(e=0;e<s;e++)r="#"+a.slider_ids[e],t=parseInt(a.gx(r).css("left")),i=parseInt(t/a.container_width*100),i-=6,a.sliders.push([a.gx(r).css("background-color"),i]);this.sliders.sort(function(e,t){return e[1]>t[1]?1:-1})},get_style_value:function(){var e=a.slider_ids.length;if(1===e)t=this.sliders[0][0];else{for(var t="",i="",r=0;r<e;r++)""==this.sliders[r][1]?t+=i+this.sliders[r][0]:(this.sliders[r][1]>100&&(this.sliders[r][1]=100),t+=i+(this.sliders[r][0]+" "+this.sliders[r][1]+"%")),i=" , ";t="linear"==this.type?this.direction+" , "+t:this.direction+" , "+this.type+" "+this.shape+" , "+t}return t},get_rgb_obj:function(e){return e=e.split("("),e=e[1],e=e.split(","),{r:parseInt(e[0]),g:parseInt(e[1]),b:parseInt(e[2])}},load_info:function(e){var t="#"+e.id;if(this.current_slider_id=t,this.slider_ids.indexOf(e.id)>-1){var i=a.gx(t).css("backgroundColor"),r=this.get_rgb_obj(i),s=a.gx(t).css("left");parseInt(s)>26&&parseInt(s)<426&&a.gx("#gradx_slider_info").css("left",s).show(),this.set_colorpicker(r),console.log(r)}},add_slider:function(e){var t,i,r,s,d;0===e.length&&(e=[{color:a.get_random_rgb(),position:a.get_random_position()},{color:a.get_random_rgb(),position:a.get_random_position()}]);var n=e;for(r in n){if("undefined"==typeof n[r].position)break;var d=26;s=parseInt(n[r].position*this.container_width/100)+d+"px",t="gradx_slider_"+this.slider_index,this.sliders.push([n[r].color,n[r].position]),this.slider_ids.push(t),i="<div class='gradx_slider' id='"+t+"'></div>",a.gx("#gradx_start_sliders_"+this.id).append(i),a.gx("#"+t).css("backgroundColor",n[r].color).css("left",s),this.slider_index++}for(var l=0,o=this.slider_ids.length;l<o;l++)a.gx("#"+this.slider_ids[l]).draggable({containment:"parent",axis:"x",start:function(){a.jQ_present&&(a.current_slider_id="#"+a.gx(this).attr("id"))},drag:function(){a.update_style_array(),a.apply_style(a.panel,a.get_style_value());var e=a.gx(a.current_slider_id).css("left");parseInt(e)>26&&parseInt(e)<426&&a.gx("#gradx_slider_info").css("left",e).show();var t=a.gx(a.current_slider_id).css("backgroundColor"),i=a.get_rgb_obj(t);a.cp.colorPicker("set",i)}}).click(function(){return a.load_info(this),!1})},set_colorpicker:function(e){a.cp.colorPicker({move:function(e){if(0!=a.current_slider_id){var t=e.toRgbString();a.gx(a.current_slider_id).css("background-color",t),a.update_style_array(),a.apply_style(a.panel,a.get_style_value())}},change:function(){a.gx("#gradx_slider_info").hide()},flat:!0,showAlpha:!0,color:e,clickoutFiresChange:!0,showInput:!0,showButtons:!1})},generate_options:function(e){for(var t,i,r=e.length,s="",a=0;a<r;a++)t=e[a].split(" "),t=t[0],i=a<2?t[1]:"",t=t.replace("-"," "),s+="<option value="+e[a]+" "+i+">"+t+"</option>";return s},generate_radial_options:function(){var e;e=["horizontal-center disabled","center selected","left","right"],a.gx("#gradx_gradient_subtype").html(a.generate_options(e)),e=["vertical-center disabled","center selected","top","bottom"],a.gx("#gradx_gradient_subtype2").html(a.generate_options(e)).show()},generate_linear_options:function(){var e;e=["horizontal-center disabled","left selected","right","top","bottom"],a.gx("#gradx_gradient_subtype").html(a.generate_options(e)),a.gx("#gradx_gradient_subtype2").hide()},destroy:function(){var e={targets:[],sliders:[],direction:"left",type:"linear",code_shown:!1,change:function(e,t){}};for(var t in e)a[t]=e[t]},load_gradx:function(e,t){this.me=a.gx(e),this.id=e.replace("#",""),e=this.id,this.current_slider_id=!1;var i="<div class='gradx'>\n                            <div id='gradx_add_slider' class='gradx_add_slider gradx_btn'><i class='icon icon-add'></i>add</div>\n                            <div class='gradx_slectboxes'>\n                            <select id='gradx_gradient_type' class='gradx_gradient_type'>\n                                <option value='linear'>Linear</option>\n                                <option value='circle'>Radial - Circle</option>\n                                <option value='ellipse'>Radial - Ellipse</option>\n                            </select>\n                            <select id='gradx_gradient_subtype' class='gradx_gradient_type'>\n                                <option id='gradx_gradient_subtype_desc' value='gradient-direction' disabled>gradient direction</option>\n                                <option value='left' selected>Left</option>\n                                <option value='right'>Right</option>\n                                <option value='top'>Top</option>\n                                <option value='bottom'>Bottom</option>\n                            </select>\n                            <select id='gradx_gradient_subtype2' class='gradx_gradient_type gradx_hide'>\n                            </select>\n                            <select id='gradx_radial_gradient_size' class='gradx_gradient_type gradx_hide'>\n                            </select>\n                            </div>\n                            <div class='gradx_container' id='gradx_"+e+"'>\n                                <div id='gradx_stop_sliders_"+e+"'></div>\n                                <div class='gradx_panel' id='gradx_panel_"+e+"'></div>\n                                <div class='gradx_start_sliders' id='gradx_start_sliders_"+e+"'>\n                                    <div class='cp-default' id='gradx_slider_info'>\n                                        <div id='gradx_slider_controls'>\n                                            <div id='gradx_delete_slider' class='gradx_btn'><i class='icon icon-remove'></i>delete</div>\n                                        </div>\n                                        <div id='gradx_slider_content'></div>\n                                    </div> \n                                </div>\n                            </div>\n                            <div id='gradx_show_code' class='gradx_show_code gradx_btn'><i class='icon icon-file-css'></i><span>show the code</span></div>\n                            <div id='gradx_show_presets' style='display:none' class='gradx_show_presets gradx_btn'><i class='icon icon-preset'></i><span>show presets</span></div>\n                            <textarea class='gradx_code' id='gradx_code'></textarea>\n                        </div>";this.me.html(i);var r=["gradient-size disabled","closest-side selected","closest-corner","farthest-side","farthest-corner","contain","cover"],s="";if(s=a.generate_options(r),a.gx("#gradx_radial_gradient_size").html(s),this.container=a.gx("#gradx_"+e),this.panel=a.gx("#gradx_panel_"+e),this.container_width=400,this.add_slider(t),a.add_event(document,"click",function(){if(!a.slider_hovered[e])return a.gx("#gradx_slider_info").hide(),!1}),a.gx("#gradx_add_slider").click(function(){a.add_slider([{color:a.get_random_rgb(),position:a.get_random_position()}]),a.update_style_array(),a.apply_style(a.panel,a.get_style_value())}),a.cp=a.gx("#gradx_slider_content"),a.set_colorpicker("blue"),a.gx("#gradx_delete_slider").click(function(){a.gx(a.current_slider_id).remove(),a.gx("#gradx_slider_info").hide();for(var e=a.current_slider_id.replace("#",""),t=0;t<a.slider_ids.length;t++)a.slider_ids[t]==e&&a.slider_ids.splice(t,1);a.update_style_array(),a.apply_style(a.panel,a.get_style_value()),a.current_slider_id=!1}),a.gx("#gradx_code").focus(function(){var e=a.gx(this);e.select(),e.mouseup(function(){return e.unbind("mouseup"),!1})}),a.gx("#gradx_gradient_type").change(function(){var e=a.gx(this).val();"linear"!==e?a.generate_radial_options():(a.generate_linear_options(),a.gx("#gradx_gradient_subtype").val("left")),a.type=e,a.direction=a.gx("#gradx_gradient_subtype").val(),a.apply_style(a.panel,a.get_style_value())}),"linear"!==this.type){a.gx("#gradx_gradient_type").val(this.type),a.generate_radial_options();var d,n;if("left"!==this.direction){var l;l=this.direction.indexOf(",")>-1?this.direction.split(","):this.direction.split(" "),d=l[0],n=l[1],a.gx("#gradx_gradient_subtype").val(d),a.gx("#gradx_gradient_subtype2").val(n)}else var d=a.gx("#gradx_gradient_subtype").val(),n=a.gx("#gradx_gradient_subtype2").val();a.direction=d+" "+n,a.apply_style(a.panel,a.get_style_value())}else"left"!==this.direction&&a.gx("#gradx_gradient_subtype").val(this.direction);a.gx("#gradx_gradient_subtype").change(function(){if("linear"===a.type)a.direction=a.gx(this).val();else{var e=a.gx(this).val(),t=a.gx("#gradx_gradient_subtype2").val();a.direction=e+" "+t}a.apply_style(a.panel,a.get_style_value())}),a.gx("#gradx_gradient_subtype2").change(function(){var e=a.gx("#gradx_gradient_subtype").val(),t=a.gx(this).val();a.direction=e+" "+t,a.apply_style(a.panel,a.get_style_value())}),a.gx("#gradx_radial_gradient_size").change(function(){a.shape=a.gx(this).val(),a.apply_style(a.panel,a.get_style_value())}),a.gx("#gradx_show_code").click(function(){a.code_shown?(a.code_shown=!1,a.gx("#gradx_show_code span").text("show the code"),a.gx("#gradx_code").hide()):(a.gx("#gradx_show_code span").text("hide the code"),a.gx("#gradx_code").show(),a.code_shown=!0)}),a.code_shown&&(a.gx("#gradx_show_code span").text("hide the code"),a.gx("#gradx_code").show()),a.add_event(document.getElementById("gradx_slider_info"),"mouseout",function(){a.slider_hovered[e]=!1}),a.add_event(document.getElementById("gradx_slider_info"),"mouseover",function(){a.slider_hovered[e]=!0})}};a.load_jQ(),t.mixin(s,i);for(var n in s)a[n]=s[n];a.load_gradx(e,a.sliders),a.apply_default_styles()};return p});
//# sourceMappingURL=sourcemaps/Gradienter.js.map
